"use strict";(self.webpackChunkpropetro_site3d=self.webpackChunkpropetro_site3d||[]).push([[810],{3810:function(e,n,o){o.r(n),o.d(n,{default:function(){return G}});var t=o(9439),i=o(9093),r=o(3655),s=o(4956),u=o(9324),c=o(5226),l=o(2791),a=o(1697),d=o(9192),f=o(3803),p=o(7577),v=o(5647),h=o(3433),m=o(7762),x=o(1413),P=o(5410),j=o(9577),g=o(7760),Z=o(184),S=["children","opacity","radius","segments","color"],y=["color","name","connectedTo","position"],R=(0,l.createContext)(),C=(0,l.forwardRef)((function(e,n){var o=e.children,t=e.opacity,i=void 0===t?1:t,r=e.radius,s=void 0===r?.05:r,u=e.segments,c=void 0===u?32:u,l=e.color,a=void 0===l?"#ff1050":l,d=(0,P.Z)(e,S);return(0,Z.jsxs)("mesh",(0,x.Z)((0,x.Z)({ref:n},d),{},{children:[(0,Z.jsx)("circleGeometry",{args:[s,c]}),(0,Z.jsx)("meshBasicMaterial",{transparent:i<1,opacity:i,color:a}),o]}))}));function b(e){var n=e.children,o=(0,l.useRef)(),i=(0,l.useState)([]),r=(0,t.Z)(i,2),s=r[0],c=r[1],a=(0,l.useMemo)((function(){var e,n=[],o=(0,m.Z)(s);try{var i=function(){var o=e.value;o.connectedTo.map((function(e){return[o.position,e.current.position]})).forEach((function(e){var o=(0,t.Z)(e,2),i=o[0],r=o[1];return n.push({start:i.clone().add({x:.35,y:0,z:0}),end:r.clone().add({x:-.35,y:0,z:0})})}))};for(o.s();!(e=o.n()).done;)i()}catch(r){o.e(r)}finally{o.f()}return n}),[s]);return(0,u.x)((function(e,n){return o.current.children.forEach((function(e){return e.children[0].material.uniforms.dashOffset.value-=10*n}))})),(0,Z.jsxs)(R.Provider,{value:c,children:[(0,Z.jsx)("group",{ref:o,children:a.map((function(e,n){return(0,Z.jsxs)("group",{children:[(0,Z.jsx)(j.R,(0,x.Z)((0,x.Z)({},e),{},{color:"white",dashed:!0,dashScale:50,gapSize:20}),n+"Bezier spot"),(0,Z.jsx)(j.R,(0,x.Z)((0,x.Z)({},e),{},{color:"red",lineWidth:3,transparent:!0,opacity:.5}),n+"Bezier line")]},n+"Bezier group")}))}),n,a.map((function(e,n){var o=e.start,t=e.end;return(0,Z.jsxs)("group",{"position-z":1,children:[(0,Z.jsx)(C,{position:o}),(0,Z.jsx)(C,{position:t})]},n+"Bezier circle")}))]})}var k=(0,l.forwardRef)((function(e,n){var o=e.color,i=void 0===o?"black":o,r=(e.name,e.connectedTo),s=void 0===r?[]:r,u=e.position,c=void 0===u?[0,0,0]:u,a=(0,P.Z)(e,y),d=(0,l.useContext)(R),f=(0,l.useState)((function(){return(0,v.Z)(g.Vector3,(0,h.Z)(c))})),p=(0,t.Z)(f,1)[0],m=(0,l.useMemo)((function(){return{position:p,connectedTo:s}}),[p,s]);return(0,l.useLayoutEffect)((function(){return d((function(e){return[].concat((0,h.Z)(e),[m])})),function(){d((function(e){return e.filter((function(e){return e!==m}))}))}}),[m,p,d]),(0,Z.jsx)(C,(0,x.Z)({ref:n,opacity:.2,radius:.5,color:i,position:p},a))})),w=[0,-Math.PI/2,0],L=[0,Math.PI/2,0],M=[0,-1,-20],z=[15,1,-10],E=[10,-1,35],A=[0,0,20],B=[0,1,20],T=[0,Math.PI/2,0],U=(0,l.lazy)((function(){return o.e(276).then(o.bind(o,4276))})),D=(0,l.memo)((0,l.lazy)((function(){return Promise.all([o.e(956),o.e(529)]).then(o.bind(o,529))})));var G=function(e){var n=(0,p.tq)(),o=(0,l.useRef)(null),v=(0,l.useRef)(null),h=(0,l.useRef)(null),m=(0,l.useRef)(null),x=(0,l.useState)(null),P=(0,t.Z)(x,2),j=P[0],S=P[1],y=(0,l.useState)(null),R=(0,t.Z)(y,2),C=R[0],G=R[1],H=(0,l.useState)(null),I=(0,t.Z)(H,2),F=I[0],N=I[1],_=(0,r.L)(a.d.TRUCK).scene,V=(0,u.w)((function(e){return e.camera})),q=(0,u.w)((function(e){return e.controls})),K=e.pumpsData.length?e.pumpsData:d.r,O=function(e,n){var o=(0,p.tq)();return{copiedScene:(0,l.useMemo)((function(){var n=[];return e.traverse((function(e){var t;if(e.isMesh){var i,r=e.material,s=null===(t=e.geometry)||void 0===t?void 0:t.boundingSphere.radius;s>10&&s<30&&n.push(e),e.material=o||s<400?new g.MeshBasicMaterial({color:r.color,reflectivity:1}):new g.MeshStandardMaterial({color:r.color,metalness:1,emissive:1,roughness:null!==(i=r.roughness)&&void 0!==i?i:.5})}})),n.forEach((function(e){e.removeFromParent()})),e.clone()}),[e.uuid])}}(_),W=O.copiedScene,J=(0,u.w)((function(e){return e.invalidate})),Q=function(e){return!F||e["Pump Position"]===F["Pump Position"]};(0,l.useEffect)((function(){F&&e.setSelected(F["Pump Position"])}),[F,e]);var X=function(n){return n["Pump Position"]===e.selected},Y=K.length/2,$=j?[j]:void 0;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(b,{children:(0,Z.jsxs)(l.Suspense,{fallback:(0,Z.jsx)(f.Z,{}),children:[K.map((function(n,o){var i=function(e,n,o){return[e<n?15:-15,0+10*o,n%e*5]}(Y,o,F&&n["Pump Position"]===F["Pump Position"]),r=(0,t.Z)(i,3),s=r[0],u=r[1],c=r[2];return(0,Z.jsx)(D,{position:[s,u,c],onClick:function(){e.setSelected(n["Pump Position"]),J()},onDoubleClick:function(){if(Q(n)){var o;null===q||void 0===q||q.saveState();var t={};t.position=V.position.clone(),t.rotation=V.rotation.clone(),t.controlCenter=null===q||void 0===q||null===(o=q.target)||void 0===o?void 0:o.clone(),G(t),e.setSelected(n["Pump Position"]),N(n),V.position.set(4.5*s,u+9,3*c),J()}},onHover:S,isActive:e.selectionOptions["Select All"]||X(n),show:Q(n),isFocussed:F&&n["Pump Position"]===F["Pump Position"],scene:W,pump:n,setAlertedParts:e.setAlertedParts,rotation:Y<o?w:L,cloudGlbURL:a.d.TRUCK,scale:F?2:1},n["Pump Position"])})),F?null:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(U,{ref:o,cloudGlbURL:a.d.MISSILE,assetId:4347,onClick:function(e){return null},onHover:S,position:A}),(0,Z.jsx)(k,{ref:v,name:"missile",position:B,connectedTo:[h]}),(0,Z.jsx)(U,{ref:h,cloudGlbURL:a.d.WELL_HEAD,onClick:function(e){return null},onHover:S,position:M,scale:5}),(0,Z.jsx)(U,{ref:m,cloudGlbURL:a.d.DATA_VAN,onClick:function(e){return null},onHover:S,position:z,rotation:T})]}),n||F?null:(0,Z.jsx)(U,{cloudGlbURL:a.d.BLENDER,onClick:function(e){return null},fast:!0,onHover:S,position:E,rotation:L})]})}),(0,Z.jsx)(c.xC,{multisampling:8,autoClear:!1,children:(0,Z.jsx)(c.bw,{selection:$,selectionLayer:1,visibleEdgeColor:"white",edgeStrength:5})}),(0,Z.jsx)(s.V,{left:!0,portal:e.domNodeRef,children:F?(0,Z.jsx)("div",{children:(0,Z.jsx)(i.h,{className:"text-neutralPrimary bg-themeLighterAlt",iconProps:{iconName:"Back"},onClick:function(){N(null),V.position.set(C.position.x,C.position.y,C.position.z),null===q||void 0===q||q.reset(),J(),J()},text:"Back to Frac site"})}):null})]})}}}]);
//# sourceMappingURL=810.7f449cb6.chunk.js.map